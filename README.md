# Ouroboros ğŸ
[![OCaml](https://img.shields.io/badge/ocaml-5.4.0-orange.svg)](https://ocaml.org/releases/ocaml-5.4.html)

Recurrent Neural Network (RNN) from scratch in OCaml to play around with **Neural Cryptanalysis**.

The main goal is to see if an RNN can learn to predict the next bit in a "random" sequence generated by a Linear Feedback Shift Register (LFSR). Since LFSRs are just deterministic math machines disguised as randomness, I'm curious to see how quickly a neural network can find the hidden recurrence and start "guessing" the future with high accuracy.

## The Challenge: Cracking the Bitstream

An LFSR works by taking a string of bits, shifting them, and feeding a new bit into the start based on a linear combination of the current state (usually some XOR logic). Even though these sequences look like noise, they are entirely predictable if you know the "taps" or the math behind them. The `LFSR` module generates the training data internally, so I have an infinite supply of sequences to feed the model.

I'm using OCaml's **Int64** to handle the bit manipulation for the LFSR generation, ensuring I have enough space to simulate 32-bit or 64-bit registers without any overflow headaches. The RNN then takes these sequences and tries to minimize its prediction error, essentially learning the "tap" configuration of the generator through pure observation.

I'm using **Owl** for the neural network operations. It provides the N-dimensional arrays and automatic differentiation.

## File Structure

I'm sticking to the standard OCaml/Dune project structure to keep things organized. Claude Sonnet 4.6 was used to plan this structure, as I am not familiar with the Ocaml/Dune project structures:

```text
ouroboros/
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â”œâ”€â”€ bin
â”‚   â”œâ”€â”€ main.ml            # The entry point to run the trainer
â”‚   â””â”€â”€ dune               # Executable config
â”œâ”€â”€ dune-project           # Dune metadata
â”œâ”€â”€ lib
â”‚   â”œâ”€â”€ LFSR.ml            # LFSR sequence generation using Int64
â”‚Â Â  â”œâ”€â”€ dune
â”‚   â”œâ”€â”€ model.ml           # The RNN architecture and forward/backward passes
â”‚Â Â  â””â”€â”€ train.ml           # Training logic and Owl optimization loops
â”œâ”€â”€ ouroboros.opam         # Package dependencies
â””â”€â”€ test
    â”œâ”€â”€ dune
    â””â”€â”€ test_ouroboros.ml
```

## Set-Up Instructions

For Debian-based systems, follow these steps to get the OCaml 5.4 environment and the Owl numerical library installed.

### 1. Install System Dependencies

Owl needs some heavy-duty linear algebra libraries to handle the matrix math.

```bash
sudo apt update
sudo apt install -y bubblewrap build-essential curl m4 unzip patch pkg-config libgsl-dev libopenblas-dev liblapacke-dev
```

### 2. Install OPAM

If you don't have the OCaml package manager yet, grab it here:

```bash
sh <(curl -sL https://raw.githubusercontent.com/ocaml/opam/master/shell/install.sh)
```

### 3. Initialize OCaml 5.4.0

I'm using a dedicated "switch" for this project to keep the OCaml 5.3 environment clean.

```bash
opam init -y
opam switch create ouroboros 5.4.0
eval $(opam env --switch=ouroboros)
```

### 4. Install Project Libraries

I need **Dune** to build the project and **Owl** to handle the tensors and gradients.

```bash
opam install -y dune owl owl-base
```

### 5. Build and Run

Run the project using Dune:

```bash
dune build
# Run the training executable
dune exec bin/main.exe
```
